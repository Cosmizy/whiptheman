<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Game</title>
    <style>
      body { margin: 0; overflow: hidden; }
    </style>
    <script type="module">
      import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.152.0/build/three.module.js';

      // Create the scene
      const scene = new THREE.Scene();

      // Set up the camera
      const camera = new THREE.PerspectiveCamera(
        75, // Field of view
        window.innerWidth / window.innerHeight, // Aspect ratio
        0.1, // Near clipping plane
        1000 // Far clipping plane
      );

      // Create the renderer and attach it to the document
      const renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.body.appendChild(renderer.domElement);

      // Create the game map
      const mapSize = 10;
      const mapGeometry = new THREE.BoxGeometry(1, 1, 1);
      const mapMaterial = new THREE.MeshBasicMaterial({ color: 0x808080 });
      for (let x = 0; x < mapSize; x++) {
        for (let z = 0; z < mapSize; z++) {
          const mapCube = new THREE.Mesh(mapGeometry, mapMaterial);
          mapCube.position.set(x - mapSize / 2, 0, z - mapSize / 2);
          scene.add(mapCube);
        }
      }

      // Create the player object
      const playerGeometry = new THREE.BoxGeometry(1, 2, 1);
      const playerMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 });
      const player = new THREE.Mesh(playerGeometry, playerMaterial);
      scene.add(player);

      // Position the camera at the player's height
      camera.position.set(0, 1.5, 0); // Adjust as needed

      // Variables for mouse controls
      let mouseX = 0;
      let mouseY = 0;
      let pitchObject = new THREE.Object3D();
      let yawObject = new THREE.Object3D();

      // Initialize pitch and yaw objects
      pitchObject.add(camera);
      yawObject.add(pitchObject);
      scene.add(yawObject);

      // Mouse control
      document.addEventListener('mousemove', (event) => {
        mouseX = (event.clientX / window.innerWidth) * 2 - 1;
        mouseY = (event.clientY / window.innerHeight) * 2 - 1;
      });

      function movePlayer() {
        const speed = 0.1;
        const direction = new THREE.Vector3();

        if (keyboard['w']) direction.z -= speed;
        if (keyboard['s']) direction.z += speed;
        if (keyboard['a']) direction.x -= speed;
        if (keyboard['d']) direction.x += speed;

        player.position.add(direction);
      }

      function updateCamera() {
        yawObject.rotation.y = -mouseX * Math.PI; // Adjust for mouse movement
        pitchObject.rotation.x = -mouseY * Math.PI / 2; // Adjust for mouse movement
      }

      function animate() {
        requestAnimationFrame(animate);

        movePlayer(); // Update player position based on controls
        updateCamera(); // Update camera orientation based on mouse input

        renderer.render(scene, camera);
      }

      // Start the animation
      animate();

      // Adjust the rendering when the window is resized
      window.addEventListener('resize', () => {
        renderer.setSize(window.innerWidth, window.innerHeight);
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
      });

      // Handle keyboard input
      const keyboard = {};
      window.addEventListener('keydown', (event) => {
        keyboard[event.key] = true;
      });

      window.addEventListener('keyup', (event) => {
        keyboard[event.key] = false;
      });
    </script>
</head>
<body>
</body>
</html>

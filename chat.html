<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chat</title>
  <style>

body, ul {
  overflow-y: hidden;
}
    /* Style for the chat messages */
    #chatContainer {
      position: relative;
      height: calc(100vh - 80px); /* Adjust the height considering the input container */
      overflow-y: auto;
      padding-bottom: 0; /* Adjust padding to prevent messages from hiding behind the input container */
    }

    #messages {
      list-style-type: none;
      margin: 0;
      padding: 0;
    }

    #messages li {
      padding: 5px 10px;
      border-bottom: 1px solid #ccc;
    }

/* Position the input container fixed at the bottom */
#inputContainer {
  position: fixed;
  bottom: 0; /* Adjust the distance from the bottom as needed */
  left: 0;
  width: 100%;
  background-color: transparent;
  padding: 10px;
  box-sizing: border-box;
  z-index: 1; /* Set a higher z-index to ensure it's above the chat container */
}

#nameInput {
  width: 125px; /* Adjust the width as needed */
}

    #codeModal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #ffffff;
      padding: 20px;
      border: 1px solid #ccc;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      z-index: 9999;
      display: none;
    }

    #codeModal input[type="text"] {
      width: 100%;
      margin-bottom: 10px;
    }

    #codeModal button {
      padding: 8px 16px;
      cursor: pointer;
    }

  </style>
</head>
<body>
  <div id="chatContainer">
    <!-- Container to display chat messages -->
    <ul id="messages"></ul>
    <!-- Input for typing a message -->
    <div id="inputContainer">
      <input type="text" id="messageInput" placeholder="Type a message...">
      <button onclick="sendMessage()">Send</button>
      <input type="text" id="nameInput" placeholder="Your Name">
    </div>
  </div>

  <div id="codeModal">
    <input type="password" id="verificationCode" placeholder="Code?">
    <button onclick="verifyCode()">Enter</button>
  </div>

  <!-- Firebase JavaScript SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.9.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.9.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.9.0/firebase-database-compat.js"></script>

  <script>
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyAK658pEbQLdrOddeU0YN-rff32xL7BuFE",
      authDomain: "test-chatroom-8133a.firebaseapp.com",
      databaseURL: "https://test-chatroom-8133a-default-rtdb.firebaseio.com",
      projectId: "test-chatroom-8133a",
      storageBucket: "test-chatroom-8133a.appspot.com",
      messagingSenderId: "1097118205649",
      appId: "1:1097118205649:web:1587d89d6953f3f32627f0",
      measurementId: "G-QPRSGK720G"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

    // Reference to the Firebase database
    var database = firebase.database().ref("messages");
    var cosmizyConfirmed = localStorage.getItem('cosmizyConfirmed') === 'true';

const blacklist = ['fuck', 'shit', 'ass', 'asshole', 'bitch', 'motherfucker', 'dick', 'cunt', 'bastard', 'cock', 'pussy', 'slut', 'nigger', 'nigga', 'faggot', 'fag', 'kike', 'retard', 'tranny', 'tits', 'cum', 'butt', 'butthole', 'sex', 'blackass', 'monkey', 'beaner', 'nega', 'niger', 'immigrant', 'rape', 'pedo', 'pedophile', 'bbc', 'balls', 'porn', 'kys', 'suicide', 'penis', 'anus', 'nazi', 'hitler', '9/11', 'twin tower', 'bomb', 'gay', 'homosexual', 'sexual', 'sexy', 'nude', 'naked', 'slave', 'slavery', 'get back to work', 'stfu', 'gtfo', 'suck my', 'semen', 'donald trump', 'joe biden', 'suck it', 'Âçê', 'autism', 'autistic', 'acoustic', 'boobs', 'vagina'];
    
// Function to clear all chats
function clearChats() {
  // Remove all messages from the chat container
  var messagesElement = document.getElementById('messages');
  messagesElement.innerHTML = '';
  
  // Remove all messages from the Firebase database
  database.remove()
    .then(function() {
      console.log("All chats cleared successfully.");
    })
    .catch(function(error) {
      console.error("Error clearing chats: ", error);
    });
}
      
function verifyCode() {
  var enteredCode = document.getElementById('verificationCode').value.trim();
  // Replace 'your_secret_code' with your actual verification code
  var secretCode = '1441';
  if (enteredCode === secretCode) {
    cosmizyConfirmed = true;
    // Save cosmizyConfirmed locally
    localStorage.setItem('cosmizyConfirmed', cosmizyConfirmed);
    // Hide the code verification modal
    document.getElementById('codeModal').style.display = 'none';
  } else {
    // Display an error message or handle the incorrect code scenario
    alert('nuh uh');
  }
}
      
// Define an array of blacklisted words

// Function to send a message
function sendMessage() {
  var name = document.getElementById('nameInput').value.trim();
  var message = document.getElementById('messageInput').value.trim();

  // Check if the name is "cosmizy"
  if (name.toLowerCase() === 'cosmizy' && !cosmizyConfirmed) {
    // Show the code verification modal
    document.getElementById('codeModal').style.display = 'block';
    return; // Exit the function without sending the message
  }

    if (message.toLowerCase() === '!clearchat' && name.toLowerCase() === 'cosmizy') {
        clearChats(); // Call the clearChats() function if conditions are met
        return; // Exit the function
    }

  // Replace blacklisted words with hashtags
  message = replaceBlacklistedWords(message);

  if (name !== '' && message !== '') {
    // Existing code to send message to Firebase
    var database = firebase.database().ref("messages");
    database.push().set({
      name: name,
      message: message,
      timestamp: firebase.database.ServerValue.TIMESTAMP
    });
    document.getElementById('messageInput').value = "";
  }
}

// Function to replace blacklisted words with hashtags
function replaceBlacklistedWords(message) {
  for (var i = 0; i < blacklist.length; i++) {
    var regex = new RegExp('\\b' + blacklist[i] + '\\w*\\b', 'gi'); // Match partial words
    var replacement = '#'.repeat(blacklist[i].length);
    message = message.replace(regex, replacement);
  }
  return message;
}


    function displayMessage(snapshot) {
      var data = snapshot.val();
      var name = data.name;
      var message = data.message;
      var messageElement = document.createElement('li');
      messageElement.innerText = name + ": " + message;
      document.getElementById('messages').appendChild(messageElement);
    }
    
    // Function to scroll to the bottom of the chat container
    function scrollToBottom() {
      var chatContainer = document.getElementById('chatContainer');
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    // Function to display messages
    database.on('child_added', function(snapshot) {
      displayMessage(snapshot);
      scrollToBottom(); // Scroll to the bottom after adding a new message
    });
    
    // Scroll to the bottom when the page is loaded
    window.onload = function() {
      scrollToBottom(); // Scroll to the bottom when the page is loaded
    };
  </script>
</body>
</html>
